---
title: "Stat 416 Assignment 1 Due Monday, September 30 at 11:59:59PM"
author: "Julia Schedler"
---

A paper I worked on as a research scientist considered the time series of the concentration (measured as $\log_{10}$ copies per Liter) of the SARS-CoV-2 virus from 5 different locations in the City of Houston, visualized in parts (c)-(g) of the figure below.

The goal of this study was to see whether the information gleaned from sampling the lift stations, which represent smaller populations, was different than the information gleaned from sampling only the larger wastewater treatment plant. In other words, one research question was to determine whether the WWTP (dark blue) time series has different dynamics (behavior) than those that represent the lift stations.

The methods in this paper are touched on in chapter 8 of our textbook. For this assignment, we will use the wastewater data as an example and practice our plotting and time series data science skills.

![(a) The WWTP catchment areas for the City of Houston, with the WWTP of focus shaded. The box shows the extent of (b), the map showing the 4 lift stations considered in the analysis. (c–g) Plot the time series of Log10 Copies/L for the WWTP and the 4 lift station facilities, referred to as Lift Station A–D, with periods of missing values indicated by grey rectangles.](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41598-024-56175-2/MediaObjects/41598_2024_56175_Fig1_HTML.png)

1.  \[6 points\] Which of the time series has the most missing data? Which appears to have the most variability? Does the overall behavior of the series seem to be similar?

2.  \[5 points\] Load the (synthetic) wastewater data from <https://raw.githubusercontent.com/hou-wastewater-epi-org/online_trend_estimation/refs/heads/main/Data/synthetic_ww_time_series.csv> using the `read.csv` function

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part 2
    ww <- read.csv(#your code here)
    ```

3.  \[5 points\] Inspect the data. Verify that each of the series from the map above are included in the .csv (hint: what are the unique values of the `name` field?)

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part3


    #your code here

    ```

4.  \[5 points\] Convert the date field to a Date format using the function as.Date.

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part4

    ww$dates <- as.Date(# your code here)

    ```

5.  \[2 points\] Install and load the `tidyverse` package.

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part5

    ## your code here

    ```

6.  \[5 points\] We will work with just the WWTP series for now. Use `dplyr::filter` to extract the values for just the WWTP series.

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part6
    ww_WWTP <- ww %>% dplyr::filter(#your code here)

    ```

7.  \[10 points\] What is the time interval between the observations? How do you know?

8.  \[10 points total\] Use the `tsplot` function from the `astsa` package to plot the `WWTP` series \[5 points\].

    Make sure to use the `dates` \[2 points\]field for the x-axis and specify good axis and plot labels using the `xlab`/`ylab`, and `main` arguments \[1 point each\]. (see the documentation `?tsplot` for more)

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part8

    ## your code here

    ```

9.  \[10 points\] Apply a moving average filter with 3 time points using the stats::filter function and save the result in a vector called `ww_ma_3`. (Similar to the final part of problem 1.1, see [here](https://juliaschedler.github.io/Stat416Fall24/LectureNotes/Lecture2.html#moving-averages-problem-1.1-part-c) in Lecture Notes).

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part9

    library(astsa)
    ww_ma_3 <- stats::filter(#your code here)
    ```

10. \[10 points\] Plot the moving average you computed on top of the tsplot in a different color using the lines function (see linked Problem 1.1 above). In the call to the lines function, also use `type = l` and `lwd = 2`.

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part10


    tsplot(# your code here)
    lines(# your code here)
    ```

11. \[15 points\] Apply the moving average filter again, but this time use 5 time points, call it `ww_ma_5`. Plot just the `WWTP` series data and the `ww_ma_5` you just computed, and use a different color for this MA process than you used in question 10.

    ```{r}
    #| echo: true
    #| eval: false
    #| label: part11

    ## your code here (similar to part 9 and 10, but with 5 time points)

    ```

12. \[5 points\] Inspect the plot you generated in questions 10 and 11. Which MA process looks "smoother"?

13. \[10 points\] Describe the different way that the missing data in the WWTP series impacts the moving average estimates for the case of 3 time points vs. 5 time points.

14. \[5 points\] Note that the data you used for this activity was "synthetic" wastewater data. Why might a researcher share a synthetic version of their data? What do you think that might mean?
